--№3
select в.фио, д.название заболевания, п.фио, б.дату обращения
from прием больных б join врачи в on б.id врача = в.id врача
					 join пациенты п on б.id врача = п.id пациента
					 join диагнозы д on б.id врача = д.id диагнозы
					 join прием больных б2 on б.id пациента = б2.id пациента 
                                          and б.id диагнозы = б2.id диагнозы 
                                          and б.id посещения <> б2.id посещения   
										  and datediff(day, б.дата обращения,  б2.дата обращения) <=365
order by п.фио, б.дата обращения, в.фио, д.название заболевания